(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2290:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),l=r(7674),a=r(5695),n=r(2115);let o=function(e){let{children:t,redirectTo:r="/auth/login"}=e,{isAuthenticated:o,isLoading:c}=(0,l.A)(),i=(0,a.useRouter)();return((0,n.useEffect)(()=>{c||o||i.push(r)},[o,c,i,r]),c)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-200 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"در حال بررسی احراز هویت..."})]})}):o?t:null};var c=r(6874),i=r.n(c);let d=function(){var e;let{user:t,logout:r}=(0,l.A)();(0,a.useRouter)();let[c,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(!1),[x,h]=(0,n.useState)({emergencyContact:"",emergencyPhone:"",medicalConditions:"",swimmingExperience:"beginner",goals:""});(0,n.useEffect)(()=>{if("register"===new URLSearchParams(window.location.search).get("action")){let e=localStorage.getItem("selectedClass");if(e)try{let t=JSON.parse(e);d(t),0===t.price&&m(!0)}catch(e){console.error("Error parsing saved class:",e),localStorage.removeItem("selectedClass")}}},[]);let g=async()=>{await r(),localStorage.removeItem("selectedClass"),window.location.href="/"},p=async e=>{e.preventDefault();try{await new Promise(e=>setTimeout(e,1e3)),alert('ثبت‌نام در کلاس "'.concat(c.title,'" با موفقیت انجام شد!')),d(null),m(!1),h({emergencyContact:"",emergencyPhone:"",medicalConditions:"",swimmingExperience:"beginner",goals:""}),localStorage.removeItem("selectedClass"),window.history.pushState({},"","/dashboard")}catch(e){console.error("Registration error:",e),alert("خطا در ثبت‌نام. لطفاً دوباره تلاش کنید.")}},b=()=>{d(null),m(!1),localStorage.removeItem("selectedClass"),window.history.pushState({},"","/dashboard")},y=async e=>{e.preventDefault();let t=new FormData(e.target).get("amount");if(!t||t<1e3)return void alert("حداقل مبلغ شارژ 1000 تومان است");alert("درخواست شارژ ".concat(parseInt(t).toLocaleString()," تومان ارسال شد"))};return(0,s.jsx)(o,{children:(0,s.jsx)("div",{className:"min-h-screen bg-gray-200 py-12",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:["سلام ",null==t?void 0:t.name]}),(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"به داشبورد شخصی خود خوش آمدید"}),(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mt-6 max-w-md mx-auto",children:[(0,s.jsx)("h3",{className:"font-bold text-gray-800 mb-2",children:"اطلاعات کاربری"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"نام:"})," ",null==t?void 0:t.name]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"ایمیل:"})," ",null==t?void 0:t.email]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"موجودی:"})," ",null==t||null==(e=t.balance)?void 0:e.toLocaleString()," ","تومان"]})]}),(0,s.jsxs)("form",{onSubmit:y,className:"mt-4",children:[(0,s.jsx)("input",{type:"number",name:"amount",placeholder:"مبلغ به تومان",min:"1000",className:"w-full px-3 py-2 border rounded-lg text-gray-900 mb-2",required:!0}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg",children:"شارژ حساب"})]})]}),(0,s.jsx)("button",{onClick:g,className:"mt-4 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg",children:"خروج از حساب"})]}),u&&c&&(0,s.jsxs)("div",{className:"mb-8 p-6 bg-blue-50 border border-blue-400 rounded-lg",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-blue-800 mb-4",children:["ثبت‌نام در کلاس: ",c.title]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg mb-6",children:[(0,s.jsx)("h4",{className:"font-bold text-lg",children:c.title}),(0,s.jsx)("p",{className:"text-gray-600",children:c.classType}),(0,s.jsx)("p",{className:"text-green-600 font-bold",children:"کلاس رایگان"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["تاریخ:"," ",new Date(c.date).toLocaleDateString("fa-IR")]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["زمان: ",c.time]})]}),(0,s.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"نام و نام خانوادگی تماس اضطراری"}),(0,s.jsx)("input",{type:"text",required:!0,value:x.emergencyContact,onChange:e=>h({...x,emergencyContact:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-gray-900",placeholder:"نام کامل شخص قابل تماس"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"شماره تماس اضطراری"}),(0,s.jsx)("input",{type:"tel",required:!0,value:x.emergencyPhone,onChange:e=>h({...x,emergencyPhone:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-gray-900",placeholder:"09xxxxxxxxx"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"تجربه شنا"}),(0,s.jsxs)("select",{value:x.swimmingExperience,onChange:e=>h({...x,swimmingExperience:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-gray-900",children:[(0,s.jsx)("option",{value:"beginner",children:"مبتدی"}),(0,s.jsx)("option",{value:"intermediate",children:"متوسط"}),(0,s.jsx)("option",{value:"advanced",children:"پیشرفته"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"مشکلات پزشکی (در صورت وجود)"}),(0,s.jsx)("textarea",{value:x.medicalConditions,onChange:e=>h({...x,medicalConditions:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-gray-900",rows:"3",placeholder:"هیچ مشکل خاصی ندارم یا ذکر مشکلات پزشکی"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"اهداف از یادگیری شنا"}),(0,s.jsx)("textarea",{value:x.goals,onChange:e=>h({...x,goals:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-gray-900",rows:"3",placeholder:"اهداف و انتظارات خود را شرح دهید"})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,s.jsx)("button",{type:"submit",className:"flex-1 bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-bold",children:"تکمیل ثبت‌نام"}),(0,s.jsx)("button",{type:"button",onClick:b,className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-bold",children:"انصراف"})]})]})]}),c&&!u&&c.price>0&&(0,s.jsxs)("div",{className:"mb-8 p-6 bg-yellow-50 border border-yellow-400 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-yellow-800 mb-4",children:"کلاس انتخاب شده برای ثبت‌نام"}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-bold text-lg",children:c.title}),(0,s.jsxs)("p",{className:"text-gray-600",children:["قیمت: ",c.price.toLocaleString()," تومان"]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,s.jsx)("button",{onClick:()=>alert("انتقال به صفحه پرداخت..."),className:"bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg",children:"پرداخت و ثبت‌نام"}),(0,s.jsx)("button",{onClick:b,className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg",children:"انصراف"})]})]})]}),!c&&!u&&(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"کلاس‌های شنا"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"مشاهده و ثبت‌نام در کلاس‌های مختلف"}),(0,s.jsx)(i(),{href:"/",className:"inline-block bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark",children:"مشاهده تمام کلاس‌ها"})]}),(0,s.jsxs)("div",{className:"bg-purple-50 p-6 rounded-lg text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"فروشگاه"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"خرید تجهیزات شنا"}),(0,s.jsx)("a",{href:"/products",className:"inline-block bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg",children:"تمام محصولات"})]})]})]})})})})}},3782:(e,t,r)=>{Promise.resolve().then(r.bind(r,2290))},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},7674:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,O:()=>o});var s=r(5155),l=r(2115),a=r(9012);let n=(0,l.createContext)();function o(e){let{children:t}=e,[r,o]=(0,l.useState)(null),[c,i]=(0,l.useState)(!0),[d,u]=(0,l.useState)(!1);(0,l.useEffect)(()=>{m()},[]);let m=async()=>{try{let e=await a.F.get("/auth/me");o(e.data.user),u(!0)}catch(e){o(null),u(!1)}finally{i(!1)}},x=async e=>{o(e),u(!0)},h=async()=>{try{await a.F.post("/auth/logout"),o(null),u(!1)}catch(e){console.error("Logout error:",e)}};return(0,s.jsx)(n.Provider,{value:{user:r,isAuthenticated:d,isLoading:c,login:x,logout:h,checkAuthStatus:m},children:t})}let c=()=>{let e=(0,l.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9012:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});let s=r(3464).A.create({baseURL:"https://parsswim-backend-production.up.railway.app",withCredentials:!0,timeout:15e3});s.interceptors.request.use(e=>e,e=>(console.error("\uD83D\uDD25 Request Error:",e),Promise.reject(e))),s.interceptors.response.use(e=>e,e=>{var t,r,s;return console.error("API Error:",(null==(t=e.response)?void 0:t.data)||e.message),(null==(r=e.response)?void 0:r.status)===401&&console.log("Authentication required"),(null==(s=e.response)?void 0:s.status)>=500&&console.error("Server error - please try again later"),Promise.reject(e)})}},e=>{e.O(0,[464,874,441,964,358],()=>e(e.s=3782)),_N_E=e.O()}]);