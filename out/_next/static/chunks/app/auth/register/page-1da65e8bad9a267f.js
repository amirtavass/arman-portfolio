(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{3974:(e,t,r)=>{"use strict";r.d(t,{L:()=>o,v:()=>i});var s=r(5041),n=r(9012),a=r(7674);let i=()=>{let{login:e}=(0,a.A)();return(0,s.n)({mutationFn:async e=>{let{name:t,password:r}=e;return(await n.F.post("/auth/login",{name:t,password:r})).data},onSuccess:t=>{e(t.user)}})},o=()=>{let{login:e}=(0,a.A)();return(0,s.n)({mutationFn:async e=>(await n.F.post("/auth/register",{...e,balance:0,swimmingType:"normal",skillLevel:"beginner"})).data,onSuccess:t=>{e(t.user)}})}},5041:(e,t,r)=>{"use strict";r.d(t,{n:()=>c});var s=r(2115),n=r(4560),a=r(7165),i=r(5910),o=r(2020),u=class extends i.Q{#e;#t=void 0;#r;#s;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.f8)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.EN)(t.mutationKey)!==(0,o.EN)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#n(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#n(),this.#a()}mutate(e,t){return this.#s=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#n(){let e=this.#r?.state??(0,n.$)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#a(e){a.jG.batch(()=>{if(this.#s&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context;e?.type==="success"?(this.#s.onSuccess?.(e.data,t,r),this.#s.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#s.onError?.(e.error,t,r),this.#s.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#t)})})}},l=r(6715);function c(e,t){let r=(0,l.jE)(t),[n]=s.useState(()=>new u(r,e));s.useEffect(()=>{n.setOptions(e)},[n,e]);let i=s.useSyncExternalStore(s.useCallback(e=>n.subscribe(a.jG.batchCalls(e)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),c=s.useCallback((e,t)=>{n.mutate(e,t).catch(o.lQ)},[n]);if(i.error&&(0,o.GU)(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:c,mutateAsync:i.mutate}}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},5959:(e,t,r)=>{Promise.resolve().then(r.bind(r,6332))},6332:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(5155),n=r(2115),a=r(3974),i=r(5695),o=r(6874),u=r.n(o);let l=function(){let[e,t]=(0,n.useState)({name:"",email:"",phone:"",age:"",password:""}),r=(0,i.useRouter)(),o=(0,a.L)(),l=r=>{t({...e,[r.target.name]:r.target.value})},c=async t=>{t.preventDefault();try{await o.mutateAsync(e),r.push("/dashboard")}catch(e){console.error("Registration failed:",e)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-200 py-12",children:(0,s.jsx)("div",{className:"max-w-md mx-auto px-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"ثبت‌نام حساب کاربری"}),(0,s.jsx)("p",{className:"text-gray-600",children:"حساب خود را ایجاد کنید"})]}),o.error&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:"خطا در ثبت‌نام. لطفا اطلاعات را بررسی کنید."}),(0,s.jsxs)("form",{onSubmit:c,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نام کاربری *"}),(0,s.jsx)("input",{type:"text",name:"name",required:!0,className:"text-gray-900 w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none",value:e.name,onChange:l})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ایمیل *"}),(0,s.jsx)("input",{type:"email",name:"email",required:!0,className:"text-gray-900 w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none",value:e.email,onChange:l})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"شماره تماس *"}),(0,s.jsx)("input",{type:"tel",name:"phone",required:!0,className:"text-gray-900 w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none",value:e.phone,onChange:l})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سن"}),(0,s.jsx)("input",{type:"number",name:"age",min:"5",max:"80",className:"text-gray-900 w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none",value:e.age,onChange:l})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رمز عبور *"}),(0,s.jsx)("input",{type:"password",name:"password",required:!0,className:"text-gray-900 w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none",value:e.password,onChange:l})]}),(0,s.jsx)("button",{type:"submit",disabled:o.isLoading,className:"w-full bg-primary hover:bg-primary-dark text-white py-3 px-6 rounded-lg font-semibold transition-colors disabled:opacity-50",children:o.isLoading?"در حال ثبت‌نام...":"ثبت‌نام"})]}),(0,s.jsxs)("div",{className:"text-center mt-8 pt-6 border-t border-gray-200",children:[(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"قبلاً حساب دارید؟"}),(0,s.jsx)(u(),{href:"/auth/login",className:"text-primary hover:underline font-medium",children:"وارد شوید"})]})]})})})}},7674:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,O:()=>o});var s=r(5155),n=r(2115),a=r(9012);let i=(0,n.createContext)();function o(e){let{children:t}=e,[r,o]=(0,n.useState)(null),[u,l]=(0,n.useState)(!0),[c,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await a.F.get("/auth/me");o(e.data.user),d(!0)}catch(e){o(null),d(!1)}finally{l(!1)}},m=async e=>{o(e),d(!0)},p=async()=>{try{await a.F.post("/auth/logout"),o(null),d(!1)}catch(e){console.error("Logout error:",e)}};return(0,s.jsx)(i.Provider,{value:{user:r,isAuthenticated:c,isLoading:u,login:m,logout:p,checkAuthStatus:h},children:t})}let u=()=>{let e=(0,n.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9012:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});let s=r(3464).A.create({baseURL:"https://parsswim-backend-production.up.railway.app",withCredentials:!0,timeout:15e3});s.interceptors.request.use(e=>e,e=>(console.error("\uD83D\uDD25 Request Error:",e),Promise.reject(e))),s.interceptors.response.use(e=>e,e=>{var t,r,s;return console.error("API Error:",(null==(t=e.response)?void 0:t.data)||e.message),(null==(r=e.response)?void 0:r.status)===401&&console.log("Authentication required"),(null==(s=e.response)?void 0:s.status)>=500&&console.error("Server error - please try again later"),Promise.reject(e)})}},e=>{e.O(0,[464,874,144,441,964,358],()=>e(e.s=5959)),_N_E=e.O()}]);